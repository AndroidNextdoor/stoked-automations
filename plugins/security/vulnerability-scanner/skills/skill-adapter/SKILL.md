---
name: Scanning for Vulnerabilities
description: |
  This skill enables comprehensive vulnerability scanning using the vulnerability-scanner plugin enhanced with Kali Linux MCP tools. It identifies security vulnerabilities in code, dependencies, configurations, and live applications, including CVE detection. Use this skill when the user asks to scan for vulnerabilities, security issues, CVEs, or run security scans. Trigger phrases include "scan for vulnerabilities", "find security issues", "check for CVEs", "run security scan", "nmap scan", "nikto scan", "/scan", or "/vuln". The plugin performs static analysis, dependency checking, configuration analysis, and live vulnerability scanning with Kali tools.
---

## Overview

This skill empowers Claude to automatically scan your codebase and live applications for security vulnerabilities. It leverages the vulnerability-scanner plugin combined with **Kali Linux MCP tools** to identify potential risks, including code-level flaws, vulnerable dependencies, insecure configurations, and runtime vulnerabilities using professional security scanners (nmap, nikto, openvas).

## How It Works

1. **Initiate Scan**: The skill activates the vulnerability-scanner plugin based on user input.
2. **Static Analysis**: Scans the codebase for code-level vulnerabilities (SQL injection patterns, XSS, etc.).
3. **Dependency Analysis**: Checks dependencies for known CVEs using vulnerability databases.
4. **Configuration Analysis**: Reviews configurations for security misconfigurations.
5. **Live Scanning**: Uses Kali MCP tools (nmap, nikto, openvas) to scan running applications.
6. **Generate Report**: Creates a detailed vulnerability report with findings, severity levels, and remediation guidance.

## When to Use This Skill

This skill activates when you need to:
- Identify security vulnerabilities in your code (SAST scanning).
- Check your project's dependencies for known CVEs.
- Review your project's configurations for security weaknesses.
- Scan running applications for vulnerabilities (DAST scanning with Kali tools).
- Perform network-level vulnerability assessment.
- Combine static and dynamic security testing.

## Examples

### Example 1: Comprehensive Application Security Scan

User request: "Run a complete security scan on my application at https://example.com"

The skill will:
1. **Static Code Analysis** - Scan codebase for vulnerabilities
2. **Dependency Check** - Verify npm/pip packages for CVEs
3. **Network Scan** - Use `mcp__kali-server__run_nmap_scan` to discover services
4. **Web Vulnerability Scan** - Use `mcp__kali-server__vulnerability_scan` with nikto
5. **Configuration Review** - Check for security misconfigurations
6. Generate comprehensive report with all findings

**Kali MCP Tools Used:**
- `run_nmap_scan`: Service discovery and version detection
- `vulnerability_scan`: Web application vulnerability scanning (nikto, openvas)
- `execute_command`: Custom vulnerability checks

### Example 2: Identifying SQL Injection Risks

User request: "Scan my code for SQL injection vulnerabilities."

The skill will:
1. **Code Analysis** - Scan codebase for SQL injection patterns
2. **Live Testing** - Use `mcp__kali-server__sql_injection_test` on running application
3. **Validation** - Verify findings with manual testing
4. Generate a report highlighting any identified SQL injection risks and providing remediation steps

**Kali MCP Tools Used:**
- `sql_injection_test`: Automated SQL injection testing with sqlmap
- `curl_request`: Manual injection payload testing

### Example 3: Checking for Vulnerable npm Packages

User request: "Check my project's npm dependencies for known vulnerabilities."

The skill will:
1. Activate the vulnerability-scanner plugin
2. Scan the project's `package.json` file and identify any npm packages with known CVEs
3. Use `mcp__kali-server__exploit_search` to find exploits for identified CVEs
4. Generate a report listing the vulnerable packages, their CVE identifiers, recommended updates, and exploitation risk

**Kali MCP Tools Used:**
- `exploit_search`: CVE and exploit database research

### Example 4: Network Infrastructure Vulnerability Assessment

User request: "Scan our production servers at 10.0.0.0/24 for vulnerabilities"

The skill will:
1. **Host Discovery** - Use `mcp__kali-server__run_nmap_scan` for network sweep
2. **Service Identification** - Detect running services and versions
3. **Vulnerability Correlation** - Use `mcp__kali-server__exploit_search` to find CVEs for services
4. **Comprehensive Scan** - Use `mcp__kali-server__vulnerability_scan` with openvas
5. Generate network vulnerability assessment report with risk prioritization

**Kali MCP Tools Used:**
- `run_nmap_scan`: Network discovery and service detection
- `vulnerability_scan`: Automated vulnerability scanning (openvas)
- `exploit_search`: CVE research and risk assessment

## Kali MCP Integration

This skill leverages the **kali-mcp** plugin for dynamic vulnerability scanning. Ensure the Kali MCP server is installed:

```bash
# Install Kali MCP plugin
/plugin install kali-mcp@stoked-automations

# Verify MCP tools are available
/mcp list | grep kali-server
```

### Scanning Methodology: SAST + DAST

This skill combines **Static Application Security Testing (SAST)** with **Dynamic Application Security Testing (DAST)** using Kali tools:

| Scan Type | Tools | Coverage |
|-----------|-------|----------|
| **SAST** | Code analysis, dependency checker | Source code vulnerabilities, CVEs in libraries |
| **DAST** | Kali MCP tools (nmap, nikto, sqlmap) | Runtime vulnerabilities, configuration issues |
| **IAST** | Combined approach | Comprehensive vulnerability detection |

### Vulnerability Scanning Workflow

```
1. Static Analysis Phase
   └─ Code pattern analysis (SQL injection, XSS, etc.)
   └─ Dependency vulnerability checking (npm audit, pip audit)
   └─ Configuration review

2. Dynamic Scanning Phase
   └─ mcp__kali-server__run_nmap_scan (service discovery)
   └─ mcp__kali-server__vulnerability_scan (automated scanning)
   └─ mcp__kali-server__web_enumeration (attack surface mapping)

3. Targeted Testing Phase
   └─ mcp__kali-server__sql_injection_test (SQLi testing)
   └─ mcp__kali-server__execute_command (custom checks)
   └─ mcp__kali-server__curl_request (manual verification)

4. Exploit Research Phase
   └─ mcp__kali-server__exploit_search (CVE research)
   └─ Risk assessment and prioritization

5. Reporting Phase
   └─ Consolidated findings report
   └─ Remediation recommendations
   └─ Document with atlassian-mcp (Jira tickets)
```

### Available Kali MCP Tools for Scanning

| MCP Tool | Scanner | Purpose |
|----------|---------|---------|
| `run_nmap_scan` | Nmap | Port/service discovery, version detection, NSE scripts |
| `vulnerability_scan` | Nikto, OpenVAS | Web vulnerabilities, configuration issues, CVEs |
| `sql_injection_test` | SQLmap | SQL injection detection and exploitation |
| `web_enumeration` | Gobuster, dirb | Hidden resources, backup files, directories |
| `exploit_search` | SearchSploit, ExploitDB | CVE research, exploit availability |
| `curl_request` | cURL | Manual HTTP testing, API analysis |
| `execute_command` | Custom tools | Specialized scanners (wpscan, joomscan, etc.) |

## Best Practices

- **Regular Scanning**: Run vulnerability scans regularly, especially before deployments.
- **Layered Approach**: Combine SAST (code analysis) with DAST (Kali tools) for comprehensive coverage.
- **Prioritize Remediation**: Focus on addressing critical and high-severity vulnerabilities first.
- **Validate Fixes**: After applying fixes, run another scan to ensure the vulnerabilities are resolved.
- **Continuous Monitoring**: Integrate scanning into CI/CD pipelines for continuous security validation.
- **Authorization**: Ensure proper authorization before scanning production systems with Kali tools.

## Integration with Other Plugins

This skill integrates seamlessly with other security and productivity plugins:

- **atlassian-mcp**: Automatically create Jira tickets for each vulnerability with severity, description, and remediation steps
- **gitlab-mcp**: Create merge requests for security fixes with automated remediation code
- **serena**: Store vulnerability scan history and track remediation progress over time
- **penetration-tester**: Follow up vulnerability findings with exploitation attempts
- **dependency-checker**: Deep dive into dependency vulnerabilities with version-specific checks

### Example: DevSecOps Workflow

```
1. Developer commits code
2. CI/CD triggers vulnerability scan
   ├─ SAST: Code analysis + dependency check
   └─ DAST: Kali MCP tools scan deployed environment
3. If vulnerabilities found:
   ├─ Create Jira tickets with atlassian-mcp
   ├─ Store findings with serena
   └─ Block deployment for critical/high severity
4. Developer fixes vulnerabilities
5. Re-scan to verify fixes
6. If clean: approve deployment
   └─ Update Jira tickets to "Resolved"
```

### Scan Types and Use Cases

**Pre-Commit Scan** (Fast)
```bash
# Quick code analysis before commit
- Static code analysis only
- Dependency CVE check
- Configuration validation
Time: 30-60 seconds
```

**Pre-Deployment Scan** (Medium)
```bash
# Comprehensive scan before release
- Full SAST analysis
- Dependency audit with exploit research
- Basic Kali MCP tools (nmap, nikto)
Time: 5-10 minutes
```

**Production Audit** (Thorough)
```bash
# Deep security assessment
- Complete SAST + DAST
- Full Kali MCP toolkit
- Exploitation validation
- Network infrastructure scan
Time: 30-60 minutes
```

## Security Metrics

Track security posture over time:

- **Vulnerability Density**: Issues per 1000 lines of code
- **Mean Time to Detect (MTTD)**: Time from vulnerability introduction to detection
- **Mean Time to Remediate (MTTR)**: Time from detection to fix
- **Coverage**: % of codebase scanned with SAST + DAST
- **Risk Score**: Weighted score based on severity and exploitability